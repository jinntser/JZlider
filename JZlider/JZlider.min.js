/*************************************
 ***  Created by JZ on 2015/11/23  ***
 ***  JZlider ver.0.9.12.29        ***
 ************************************/

(function(l){function u(b,u){function I(){1<h&&!b.find(".slide").is(":animated")&&(a=l(this).index(),a!=e&&(f=a>e?"right":"left",r(),l(this).eq(a).addClass("active").siblings().removeClass("active")),1==c.debug&&console.log("slide_now = "+e+"\nslide_next = "+a))}function J(){if(1<h&&!b.find(".slide").is(":animated")){var y=0<l(this).attr("class").indexOf("left")?0:1;if(1==y){if(a==h-1)if(1==c.cycling)a=0;else return!1;else a++;f="right";1==c.debug&&console.log("slide_now = "+e+"\nslide_next = "+a+"\ndire = "+f)}else if(0==y){if(0==a)if(1==c.cycling)a=h-1;else return!1;else a--;f="left";1==c.debug&&console.log("slide_now = "+e+"\nslide_next = "+a+"\ndire = "+f)}r()}}function n(){p=setTimeout(function(){f="right";1==c.cycling?(a==h-1?a=0:a++,r()):a!=h-1&&(a++,r())},c.stayTime)}function r(){"right"==f?(v="100%",w="-100%"):"left"==f&&(v="-100%",w="100%");b.find(".slide").eq(a).css({top:0,left:v,display:"block"}).animate({left:"0"},c.speed);b.find(".slide").eq(e).animate({left:w},c.speed,function(){b.find(".slide").eq(e).css({display:"none",position:"absolute"});b.find(".slide").eq(a).css({position:"relative"});e=a;1==c.debug&&console.log("slide_now = "+e+"\nslide_next = "+a)});1==c.bullet&&b.find(".bullet").eq(a).addClass("active").siblings().removeClass("active");1==c.autoPlay&&(clearTimeout(p),n());1==c.debug&&console.log("slide_now = "+e+"\nslide_next = "+a)}function x(){m.addEventListener("touchstart",z,!1);m.addEventListener("touchmove",A,!1);m.addEventListener("touchend",B,!1)}function C(){m.removeEventListener("touchstart",z,!1);m.removeEventListener("touchmove",A,!1);m.removeEventListener("touchend",B,!1)}function z(b){d=0;D=b.touches[0].pageX;0==q&&(k=e,t=!0);1==c.autoPlay&&p&&clearTimeout(p);1==c.debug&&console.log("drag start")}function A(a){a.preventDefault();1==t&&(d=parseInt(Math.floor(100*(a.touches[0].pageX-D)/K)),0<d?0==e?1==c.cycling?g=h-1:(d=0,g=null):g=k-1:0>d&&(e==h-1?1==c.cycling?g=0:(d=0,g=null):g=k+1),a=d,b.find(".slide").eq(k).css({top:0,left:a+"%"}),null!=g&&(0<a?b.find(".slide").eq(g).css({top:0,left:-100+a+"%",display:"block"}):b.find(".slide").eq(g).css({top:0,left:100+a+"%",display:"block"})));1==c.debug&&console.log(d)}function B(a){1==t&&(20<=d?(f="left",E()):-20>=d?(f="right",E()):0<d&&20>d?(f="right",F()):0>d&&-20<d?(f="left",F()):0==d&&b.find(".slide").eq(k).css({left:0}).siblings(".slide").css("display","none"));t=!1}function F(){var a="left"==f?100:-100;q=!0;C();b.find(".slide").eq(g).animate({left:a+"%"},.5*c.speed);b.find(".slide").eq(k).animate({left:0},.5*c.speed,function(){b.find(".slide").eq(k).siblings(".slide").css({display:"none",position:"absolute"});x();1==c.autoPlay&&n();q=!1})}function E(){var d="left"==f?100:-100;q=!0;C();e=a=g;b.find(".bullet").eq(g).addClass("active").siblings().removeClass("active");b.find(".slide").eq(g).animate({left:0},.5*c.speed,function(){b.find(".slide").eq(g).css("position","relative").siblings(".slide").css({display:"none",position:"absolute"});x();1==c.autoPlay&&n();q=!1});b.find(".slide").eq(k).animate({left:d+"%"},.5*c.speed)}var h=b.find(".slide").length,e=0,a=0,v="100%",w="-100%",G="JZlider"+Math.floor(new Date)+Math.floor(1E4*Math.random()),p,f,c={speed:500,stayTime:5E3,autoPlay:!0,direCtr:!1,bullet:!1,cycling:!0,hoverPause:!0,debug:!1};l.extend(c,u);b.addClass("JZlider").find(".slide").wrapAll('<div class="slide-box"><div class="slide-wrap" id="'+G+'"></div></div>');b.find(".slide").eq(0).siblings(".slide").css({display:"none",position:"absolute"});1==c.debug&&console.log("JZlider debug mode:");if(1==c.bullet){b.append('<div class="bullet-wrap"></div>');for(var H=0;H<h;H++)b.find(".bullet-wrap").append('<div class="bullet"></div>');b.find(".bullet").bind("click",I);b.find(".bullet").eq(a).addClass("active")}1==c.direCtr&&(b.find(".slide-box").append('<div class="JZlider-control left"></div><div class="JZlider-control right"></div>'),b.find(".JZlider-control").bind("click",J));1==c.autoPlay&&1<h&&(n(),1==c.hoverPause&&(1==c.debug&&console.log("hoverPause on"),b.find(".slide").hover(function(){clearTimeout(p)},function(){n()})));var D,d,m=document.getElementById(G),K=l(window).width(),k=null,g,q=!1,t=!1;1<h&&x()}l.fn.extend({JZlider:function(b){return this.each(function(){u(l(this),b)})}})})(jQuery);